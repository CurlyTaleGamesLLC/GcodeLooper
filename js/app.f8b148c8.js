(function(){"use strict";var t={6736:function(t,e,o){var i=o(7195),n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("GCodeLooper")],1)},r=[],a=function(){var t=this,e=t._self._c;return e("div",[e("b-container",[e("b-row",[e("b-col",[e("h1",{staticClass:"font-weight-bolder"},[t._v("GCode Looper")]),e("img",{attrs:{src:o(6925)}}),e("p",{staticClass:"mt-3 mb-4"},[t._v("Upload a GCode file to print and eject multiple copies of your 3D print.")]),e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".gcode"},on:{change:t.onFileChange}}),e("div",{staticClass:"dropzone",on:{click:t.browseFile,drop:function(e){return e.preventDefault(),t.onDrop.apply(null,arguments)},dragover:function(t){t.preventDefault()}}},[e("span",{staticClass:"font-weight-bolder"},[t._v("Drag & Drop GCode File Here")]),e("br"),e("span",{staticClass:"browse-link"},[t._v("Browse to Upload")])]),e("p",{staticClass:"my-3"},[e("small",[t._v("Currently only supports single object gcode files sliced with latest PrusaSlicer")])])])],1),t.gcodeText?e("hr",{staticClass:"my-3"}):t._e(),e("b-row",[e("b-col",{staticClass:"mb-3 mt-2",attrs:{md:"6"}},[t.thumbnailSrc?e("img",{staticClass:"w-100",attrs:{src:t.thumbnailSrc,alt:"Thumbnail preview"}}):t._e(),t.fileName?e("h3",{staticClass:"filename-display"},[t._v(t._s(t.fileName))]):t._e(),t.fileName?e("b-table-simple",{staticClass:"mt-3",attrs:{responsive:"",striped:"",bordered:"",small:""}},[e("b-tbody",[e("b-tr",{staticClass:"text-center bg-info text-white table-header"},[e("b-td",{attrs:{colspan:2}},[t._v("File Specifications")])],1),e("b-tr",[e("b-td",[t._v("Bed Position [X,Y]")]),e("b-td",[t._v(t._s(((t.gcodeData.bounds.maxX+t.gcodeData.bounds.minX)/2).toFixed(2))+", "+t._s(((t.gcodeData.bounds.maxY+t.gcodeData.bounds.minY)/2).toFixed(2)))])],1),e("b-tr",[e("b-td",[t._v("Height")]),e("b-td",[t._v(t._s(t.gcodeData.height.toFixed(2)))])],1),e("b-tr",[e("b-td",[t._v("Width")]),e("b-td",[t._v(t._s((t.gcodeData.bounds.maxX-t.gcodeData.bounds.minX+t.gcodeData.extrusionWidth).toFixed(2)))])],1),e("b-tr",[e("b-td",[t._v("Length")]),e("b-td",[t._v(t._s((t.gcodeData.bounds.maxY-t.gcodeData.bounds.minY+t.gcodeData.extrusionWidth).toFixed(2)))])],1),e("b-tr",[e("b-td",[t._v("X Bounds [min,max]")]),e("b-td",[t._v(t._s((t.gcodeData.bounds.minX-t.gcodeData.extrusionWidth/2).toFixed(2))+", "+t._s((t.gcodeData.bounds.maxX+t.gcodeData.extrusionWidth/2).toFixed(2)))])],1),e("b-tr",[e("b-td",[t._v("Y Bounds [min,max]")]),e("b-td",[t._v(t._s((t.gcodeData.bounds.minY-t.gcodeData.extrusionWidth/2).toFixed(2))+", "+t._s((t.gcodeData.bounds.maxY+t.gcodeData.extrusionWidth/2).toFixed(2)))])],1)],1)],1):t._e(),t.gcodeText?e("div",{staticClass:"gcode-window mt-4"},[e("pre",[t._v(t._s(t.gcodeText))])]):t._e(),t.gcodeText?e("small",[t._v("Original GCode")]):t._e()],1),e("b-col",{staticClass:"mb-3",attrs:{md:"6"}},[t.gcodeText?e("b-form",{on:{submit:function(t){t.preventDefault()}}},[t.fileName?e("b-table-simple",{staticClass:"mt-2",attrs:{responsive:"",striped:"",bordered:"",small:""}},[e("b-tbody",[e("b-tr",{staticClass:"text-center bg-info text-white table-header"},[e("b-td",{attrs:{colspan:2}},[t._v("Estimated Totals")])],1),e("b-tr",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Days : Hours : Minutes : Seconds"}},[e("b-td",[t._v("Print Time")]),e("b-td",[t._v(t._s(t.gcodeData.totalPrintTime))])],1),e("b-tr",[e("b-td",[t._v("Grams of Filament")]),e("b-td",[t._v(t._s(t.gcodeData.totalGramsOfFilament))])],1),e("b-tr",[e("b-td",[t._v("Cost of Filament")]),e("b-td",[t._v(t._s(t.gcodeData.totalCostOfFilament))])],1)],1)],1):t._e(),e("b-input-group",{staticClass:"mb-3"},[e("b-input-group-text",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"The number of copies of your 3D print."}},[t._v("Copies:")]),e("b-form-input",{attrs:{type:"number",min:"1",required:""},model:{value:t.form.copies,callback:function(e){t.$set(t.form,"copies",e)},expression:"form.copies"}})],1),e("b-input-group",{staticClass:"mb-3"},[e("b-input-group-text",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"The side of your 3D printer you want the parts to be ejected from."}},[t._v("Ejection Side:")]),e("b-form-select",{attrs:{options:["Left","Right","Front","Back"],required:""},model:{value:t.form.ejectionSide,callback:function(e){t.$set(t.form,"ejectionSide",e)},expression:"form.ejectionSide"}})],1),"Back"===t.form.ejectionSide?e("b-input-group",{staticClass:"mb-3"},[e("b-input-group-text",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"The length in millimeters of the bed of your 3D printer. This will be used for the ejection of each print."}},[t._v("Bed Length (mm):")]),e("b-form-input",{attrs:{type:"number",step:"0.01",required:""},model:{value:t.form.bedLength,callback:function(e){t.$set(t.form,"bedLength",e)},expression:"form.bedLength"}})],1):t._e(),"Right"===t.form.ejectionSide?e("b-input-group",{staticClass:"mb-3"},[e("b-input-group-text",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"The length in millimeters of the bed of your 3D printer. This will be used for the ejection of each print."}},[t._v("Bed Width (mm):")]),e("b-form-input",{attrs:{type:"number",step:"0.01",required:""},model:{value:t.form.bedWidth,callback:function(e){t.$set(t.form,"bedWidth",e)},expression:"form.bedWidth"}})],1):t._e(),e("b-input-group",{staticClass:"mb-3"},[e("b-input-group-text",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"How far the nozzle of your 3D printer will move away from the bounds of your part when it is ejected."}},[t._v("Print Head Offset (mm):")]),e("b-form-input",{attrs:{type:"number",step:"0.01",required:""},model:{value:t.form.ejectionOffset,callback:function(e){t.$set(t.form,"ejectionOffset",e)},expression:"form.ejectionOffset"}})],1),e("b-input-group",{staticClass:"mb-3"},[e("b-input-group-text",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"How far the nozzle of your 3D printer will be raised off the print bed while the part is ejected"}},[t._v("Push Height (mm):")]),e("b-form-input",{attrs:{type:"number",step:"0.01",required:""},model:{value:t.form.pushHeight,callback:function(e){t.$set(t.form,"pushHeight",e)},expression:"form.pushHeight"}})],1)],1):t._e(),t.gcodeText?e("b-button",{attrs:{variant:"success"},on:{click:t.downloadFile}},[t._v("Download New GCode")]):t._e()],1)],1),e("b-row",{staticClass:"my-4"},[e("b-col",[e("p",[t._v("Finding this web app useful? Consider donating")]),e("a",{staticClass:"btn btn-light mx-2",attrs:{href:"https://github.com/sponsors/CurlyTaleGames",target:"_blank"}},[e("img",{attrs:{src:o(2405),alt:"Github Sponsors",height:"22px"}}),t._v(" GitHub Sponsors ")]),e("a",{staticClass:"btn btn-light mx-2",attrs:{href:"https://www.paypal.com/donate/?hosted_button_id=L4GAK93DRELFW",target:"_blank"}},[e("img",{attrs:{src:o(3607),alt:"PayPal",height:"22px"}})])])],1)],1)],1)},s=[],l=(o(6229),o(7330),o(2062),{data(){return{gcodeText:"",thumbnailSrc:"",fileName:"",newFileName:"",form:{copies:10,ejectionSide:"Front",pushHeight:20,ejectionOffset:40,bedLength:null,bedWidth:null},gcodeData:{height:0,minX:0,maxX:0,minY:0,maxY:0,extrusionWidth:0,bounds:{minX:0,maxX:0,minY:0,maxY:0},printTimeSeconds:0,totalPrintTime:0,totalGramsOfFilament:0,totalCostOfFilament:0}}},methods:{browseFile(){this.$refs.fileInput.click()},replaceFile(){this.gcodeText="",this.thumbnailSrc="",this.fileName="",this.$refs.fileInput.click()},onFileChange(t){const e=t.target.files||t.dataTransfer.files;e.length&&("gcode"===e[0].name.split(".").pop().toLowerCase()?(this.fileName=e[0].name,this.createFile(e[0])):alert("Invalid file type. Please upload a .gcode file."))},onDrop(t){const e=t.dataTransfer.files;e.length&&("gcode"===e[0].name.split(".").pop().toLowerCase()?this.onFileChange(t):alert("Invalid file type. Please upload a .gcode file."))},createFile(t){const e=new FileReader;e.onload=t=>{this.gcodeText=t.target.result,this.thumbnailSrc=this.extractLargestThumbnail(this.gcodeText),this.gcodeData.extrusionWidth=this.parseExtrusionWidth(this.gcodeText),this.gcodeData.height=this.parseZHeight(this.gcodeText),this.gcodeData.printTimeSeconds=this.parseAndConvertTime(this.gcodeText),this.gcodeData.bounds=this.findBounds(this.gcodeText)},e.readAsText(t)},extractLargestThumbnail(t){console.log("Extracting Text"),console.log(t);const e=t.match(/; thumbnail begin (\d+)x(\d+) (\d+)([\s\S+]*?); thumbnail end/g);if(!e)return"";let o="",i=0;return e.forEach((t=>{console.log(t);const e=t.match(/; thumbnail begin (\d+)x(\d+) (\d+)/);if(e){const n=parseInt(e[1],10),r=parseInt(e[2],10),a=n*r;if(a>i){i=a;let e=t.replace(/^.*\n|\n|;\s*/g,"");e=e.replace(/=thumbnail end/g,"="),o="data:image/png;base64, "+e}}})),o},downloadFile(){const t=new Blob([this.gcodeText],{type:"text/plain"}),e=document.createElement("a");e.href=URL.createObjectURL(t),e.download=this.createNewFilename(this.fileName,this.form.copies,this.gcodeData.printTimeSeconds)||"downloaded.gcode",e.click()},parseZHeight(t){let e=0;const o=t.split("\n");return o.forEach((t=>{if(t.startsWith(";Z:")){const o=parseFloat(t.split(";Z:")[1]);o>e&&(e=o)}})),e},parseAndConvertTime(t){const e=t.match(/estimated printing time.*?(?:(\d+)d )?(?:(\d+)h )?(\d+)m (\d+)s/);if(e){const t=parseInt(e[1]||0,10),o=parseInt(e[2]||0,10),i=parseInt(e[3],10),n=parseInt(e[4],10),r=86400*t+3600*o+60*i+n;return r}return console.warn("Could not parse estimated printing time from G-code"),null},parseGramsOfFilament(t){const e=t.match(/total filament used \[g\] = ([0-9.]+)/);if(e){const t=parseFloat(e[1]);return t}return console.warn("Could not parse total grams of filament used from G-code"),null},parseExtrusionWidth(t){const e=t.match(/; extrusion_width = (\d+(\.\d+)?)/);if(e){const t=parseFloat(e[1]);return t}return console.warn("Could not parse extrusion width used from G-code"),null},parseFilamentCost(t){const e=t.match(/; total filament cost = (\d+(\.\d+)?)/);return e&&e[1]?parseFloat(e[1]):(console.error("Filament cost not found in gcode text."),0)},convertSecondsToTimeFormat(t){const e=Math.floor(t/86400),o=Math.floor(t%86400/3600),i=Math.floor(t%3600/60),n=t%60,r=[e,o,i,n].map((t=>(t<10?"0":"")+t)).join(":");return r},convertSecondsToDayHourMinuteFormat(t){const e=Math.floor(t/86400);t-=86400*e;const o=Math.floor(t/3600);t-=3600*o;const i=Math.floor(t/60);let n="";return e>0&&(n+=`${e}d`),o>0&&(n+=`${o}h`),i>0&&(n+=`${i}m`),n||(n="0m"),n},createNewFilename(t,e,o){const i=t.split("_");if(i.length>=3){const t=i[0],n=i.slice(1,-1).join("_");return t+"-x"+e+"_"+n+"_"+this.convertSecondsToDayHourMinuteFormat(e*o)+".gcode"}return console.warn("Not enough underscores found in filename"),[t]},findBounds(t){let e=!1,o=1/0,i=-1/0,n=1/0,r=-1/0;const a=t.split("\n");for(const s of a)if(s.includes(";TYPE:External perimeter"))e=!0;else if(e&&s.includes(";WIPE_START")&&(e=!1),e&&s.startsWith("G1")){const t=this.extractXYCoords(s);if(t){const{x:e,y:a}=t;o=Math.min(o,e),i=Math.max(i,e),n=Math.min(n,a),r=Math.max(r,a)}}return{minX:o===1/0?null:o,maxX:i===-1/0?null:i,minY:n===1/0?null:n,maxY:r===-1/0?null:r}},extractXYCoords(t){const e=t.match(/X([-\d.]+)/),o=t.match(/Y([-\d.]+)/);return e&&o?{x:parseFloat(e[1]),y:parseFloat(o[1])}:null}},computed:{totalPrintTimeSeconds(){return this.gcodeData.printTimeSeconds*this.form.copies},totalPrintTime(){return this.convertSecondsToTimeFormat(this.totalPrintTimeSeconds)},totalGramsOfFilament(){return(this.parseGramsOfFilament(this.gcodeText)*this.form.copies).toFixed(2)},totalCostOfFilament(){return"$"+(this.parseFilamentCost(this.gcodeText)*this.form.copies).toFixed(2)}},watch:{totalPrintTime(t){this.gcodeData.totalPrintTime=t},totalGramsOfFilament(t){this.gcodeData.totalGramsOfFilament=t},totalCostOfFilament(t){this.gcodeData.totalCostOfFilament=t}}}),d=l,c=o(1001),u=(0,c.Z)(d,a,s,!1,null,null,null),m=u.exports,p={name:"App",components:{GCodeLooper:m}},f=p,h=(0,c.Z)(f,n,r,!1,null,null,null),b=h.exports,g=o(9546),v=o(7244),x=o(8188);o(7024);i["default"].use(g.XG7),i["default"].use(v.A7),i["default"].use(x.D);x.D;i["default"].config.productionTip=!1,new i["default"]({render:t=>t(b)}).$mount("#app")},3607:function(t,e,o){t.exports=o.p+"img/PayPal.7e17962e.svg"},6925:function(t,e,o){t.exports=o.p+"img/gcode-looper-logo.9dd141c1.svg"},2405:function(t,e,o){t.exports=o.p+"img/github.91e0053a.svg"}},e={};function o(i){var n=e[i];if(void 0!==n)return n.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,o),r.exports}o.m=t,function(){var t=[];o.O=function(e,i,n,r){if(!i){var a=1/0;for(c=0;c<t.length;c++){i=t[c][0],n=t[c][1],r=t[c][2];for(var s=!0,l=0;l<i.length;l++)(!1&r||a>=r)&&Object.keys(o.O).every((function(t){return o.O[t](i[l])}))?i.splice(l--,1):(s=!1,r<a&&(a=r));if(s){t.splice(c--,1);var d=n();void 0!==d&&(e=d)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[i,n,r]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.p="/GcodeLooper/"}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,i){var n,r,a=i[0],s=i[1],l=i[2],d=0;if(a.some((function(e){return 0!==t[e]}))){for(n in s)o.o(s,n)&&(o.m[n]=s[n]);if(l)var c=l(o)}for(e&&e(i);d<a.length;d++)r=a[d],o.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return o.O(c)},i=self["webpackChunkgcode_looper"]=self["webpackChunkgcode_looper"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=o.O(void 0,[998],(function(){return o(6736)}));i=o.O(i)})();
//# sourceMappingURL=app.f8b148c8.js.map